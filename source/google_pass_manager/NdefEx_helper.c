#include "NdefEx_helper.h"

LongTermPrivateKey testLongTermPrivateKeys[] = {
		{
			.cid = {0x01, 0x33, 0xEE, 0x80},
			.ver = {0x00, 0x00, 0x00, 0x01},
			.key = {
				0x82, 0x6D, 0x17, 0xE5, 0x07, 0x67, 0xB1, 0x65,
				0xB0, 0xE4, 0xD9, 0xE3, 0x32, 0xF8, 0xD1, 0xD1,
				0xE2, 0x02, 0x24, 0x28, 0x4F, 0xB4, 0xDA, 0xF1,
				0xE5, 0x0A, 0x03, 0x24, 0x6E, 0x70, 0x79, 0x7D
			}
		},
		{
			.cid = {0x00, 0xBC, 0x61, 0x4E},
			.ver = {0x00, 0x00, 0x00, 0x01},
			.key = {
				0x82, 0x6d, 0x17, 0xe5, 0x07, 0x67, 0xb1, 0x65,
				0xb0, 0xe4, 0xd9, 0xe3, 0x32, 0xf8, 0xd1, 0xd1,
				0xe2, 0x02, 0x24, 0x28, 0x4f, 0xb4, 0xda, 0xf1,
				0xe5, 0x0a, 0x03, 0x24, 0x6e, 0x70, 0x79, 0x7d
			}
		},
		{
			.cid = {0x02, 0x3E, 0x68, 0xAF},
			.ver = {0x00, 0x00, 0x00, 0x01},
			.key = {
				0xE1, 0x28, 0xE8, 0xDD, 0x26, 0xE1, 0x56, 0xFC,
				0xEC, 0xF4, 0xDB, 0xAC, 0x85, 0x4D, 0x49, 0xCC,
				0xEE, 0x44, 0x99, 0x6C, 0x72, 0x9E, 0x27, 0x85,
				0xDC, 0xD0, 0xB2, 0xEB, 0x20, 0x14, 0x60, 0xEC
			}
		},
		{
			.cid = {0x02, 0x3E, 0x68, 0xAF},
			.ver = {0x00, 0x00, 0x00, 0x03},
			.key = {
				0x1E, 0x69, 0x1F, 0xBC, 0x1C, 0xC1, 0xF1, 0xF1,
				0x71, 0x15, 0xEC, 0xEE, 0xC0, 0x5E, 0xE4, 0x48,
				0xB8, 0xD3, 0xF1, 0x66, 0x85, 0xC3, 0x0E, 0x42,
				0x24, 0xE9, 0xB5, 0x04, 0xD1, 0x78, 0xDB, 0x69
			}
		}
};



// Random bytes generator
// Seed the random number generator (only once at program start is better)
static int seeded = 0;
void GenerateRandomBytes(uint8_t *buf, size_t len)
{
    if (!seeded) {
        srand(time(NULL));
        seeded = 1;
    }
    for (size_t i = 0; i < len; i++)
    {
        buf[i] = rand() % 256;
    }
}

// Function to generate a simple random 8-byte Session ID
// **In a real-world application might use a cryptographically secure random number generator**
void GenerateSessionID(uint8_t *sessionID) {
	GenerateRandomBytes(sessionID, 8);
}

void GenerateTerminalNonce(uint8_t *termNonce) {
	GenerateRandomBytes(termNonce, 32);
}

LongTermPrivateKey* GetTestPrivateKeys(void) {
	return testLongTermPrivateKeys;
}
